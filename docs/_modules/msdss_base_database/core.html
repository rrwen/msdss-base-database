
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>msdss_base_database.core &#8212; 0.1.1</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=indigo data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#_modules/msdss_base_database/core" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="0.1.1"
           class="md-header-nav__button md-logo">
          
              <img src="../../_static/logo.svg" height="26"
                   alt="0.1.1 logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">msdss-base-database</span>
          <span class="md-header-nav__topic"> msdss_base_database.core </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/rrwen/msdss-base-database/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    msdss-base-database
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">0.1.1</a></li>
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Module code</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="0.1.1" class="md-nav__button md-logo">
      
        <img src="../../_static/logo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="0.1.1">msdss-base-database</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/rrwen/msdss-base-database/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    msdss-base-database
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../install.html" class="md-nav__link">Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../quickstart.html" class="md-nav__link">Quick Start</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../howitworks.html" class="md-nav__link">How it Works</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../reference/index.html" class="md-nav__link">API Reference</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
    

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <h1 id="modules-msdss-base-database-core--page-root">Source code for msdss_base_database.core</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">sqlalchemy</span>

<span class="kn">from</span> <span class="nn">.defaults</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.env</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.tools</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="Database"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database">[docs]</a><span class="k">class</span> <span class="nc">Database</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Class for MSDSS database management.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    driver : str</span>
<span class="sd">        The driver name of the database connection, which are commonly ``postgresql``, ``sqlite``, ``mysql``, ``oracle`` or ``mssql`` (see `SQLAlchemy supported databases &lt;https://docs.sqlalchemy.org/en/14/core/engines.html#supported-databases&gt;`_).</span>
<span class="sd">    user : str</span>
<span class="sd">        User name for the connection.</span>
<span class="sd">    password : str</span>
<span class="sd">        Password for the user.</span>
<span class="sd">    host : str</span>
<span class="sd">        Host address of the connection.</span>
<span class="sd">    port : str</span>
<span class="sd">        Port number of the connection.</span>
<span class="sd">    database : str</span>
<span class="sd">        Database name of the connection.</span>
<span class="sd">    load_env : bool</span>
<span class="sd">        Whether to load the environmental variables using parameter ``env`` or not.  The environment will only be loaded if the ``env_file`` exists.</span>
<span class="sd">    env : :class:`msdss_base_database.env.DatabaseDotEnv` or bool</span>
<span class="sd">        An object to set environment variables related to database configuration.</span>
<span class="sd">        These environment variables will overwrite the parameters above if they exist.</span>

<span class="sd">        By default, the parameters above are assigned to each of the environment variables below:</span>

<span class="sd">        .. jupyter-execute::</span>
<span class="sd">            :hide-code:</span>

<span class="sd">            from msdss_base_database.defaults import DEFAULT_DOTENV_KWARGS</span>
<span class="sd">            defaults = {k:v for k, v in DEFAULT_DOTENV_KWARGS.items() if k not in ['defaults', 'env_file', 'key_path']}</span>
<span class="sd">            print('&lt;parameter&gt; = &lt;environment variable&gt;\\n')</span>
<span class="sd">            for k, v in defaults.items():</span>
<span class="sd">                print(k + ' = ' + v)</span>

<span class="sd">    *args, **kwargs</span>
<span class="sd">        Additional arguments passed to :func:`sqlalchemy:sqlalchemy.create_engine`.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    _connection : :class:`sqlalchemy.engine.base.Engine`</span>
<span class="sd">        The database engine object from `sqlalchemy &lt;https://www.sqlalchemy.org/&gt;`_.</span>
<span class="sd">    _inspector: :class:`sqlalchemy.engine.reflection.Inspector`</span>
<span class="sd">        The database inspector object from `sqlalchemy &lt;https://www.sqlalchemy.org/&gt;`_.</span>
<span class="sd">    _metadata : :class:`sqlalchemy.schema.MetaData`</span>
<span class="sd">        The metadata object from `sqlalchemy &lt;https://www.sqlalchemy.org/&gt;`_.</span>

<span class="sd">    Author</span>
<span class="sd">    ------</span>
<span class="sd">    Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    .. jupyter-execute::</span>

<span class="sd">        from msdss_base_database import Database</span>

<span class="sd">        # Initiate a connection with the default test user and database</span>
<span class="sd">        db = Database()</span>

<span class="sd">        # Check if the table exists and drop if it does</span>
<span class="sd">        if db.has_table("test_table"):</span>
<span class="sd">            db.drop_table("test_table")</span>

<span class="sd">        # Create sample table</span>
<span class="sd">        columns = [</span>
<span class="sd">            dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">            ('column_one', 'String'),</span>
<span class="sd">            ('column_two', 'Integer')</span>
<span class="sd">        ]</span>
<span class="sd">        db.create_table('test_table', columns)</span>

<span class="sd">        # Write sample data</span>
<span class="sd">        data = {</span>
<span class="sd">            'id': [1, 2, 3],</span>
<span class="sd">            'column_one': ['a', 'b', 'c'],</span>
<span class="sd">            'column_two': [2, 4, 6]</span>
<span class="sd">        }</span>
<span class="sd">        db.insert('test_table', data)</span>

<span class="sd">        # Read the table to a pandas dataframe</span>
<span class="sd">        df = db.select('test_table')</span>

<span class="sd">        # Insert values into the table</span>
<span class="sd">        new = {</span>
<span class="sd">            'id': [5, 6, 7],</span>
<span class="sd">            'column_one': ['e', 'f', 'g'],</span>
<span class="sd">            'column_two': [10, 12, 14]</span>
<span class="sd">        }</span>
<span class="sd">        db.insert('test_table', new)</span>
<span class="sd">        df_insert = db.select('test_table')</span>

<span class="sd">        # Delete rows from the table</span>
<span class="sd">        db.delete(</span>
<span class="sd">            'test_table',</span>
<span class="sd">            where=('id', '=', 5)</span>
<span class="sd">        )</span>
<span class="sd">        df_delete = db.select('test_table')</span>

<span class="sd">        # Update values in table</span>
<span class="sd">        db.update(</span>
<span class="sd">            'test_table',</span>
<span class="sd">            where=('id', '&gt;', 3),</span>
<span class="sd">            values={'column_one': 'AA'})</span>
<span class="sd">        df_update = db.select('test_table')</span>

<span class="sd">        # Display results</span>
<span class="sd">        print('df:\\n')</span>
<span class="sd">        print(df)</span>
<span class="sd">        print('\\ndf_insert:\\n')</span>
<span class="sd">        print(df_insert)</span>
<span class="sd">        print('\\ndf_delete:\\n')</span>
<span class="sd">        print(df_delete)</span>
<span class="sd">        print('\\ndf_update:\\n')</span>
<span class="sd">        print(df_update)</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">driver</span><span class="o">=</span><span class="n">DEFAULT_DOTENV_KWARGS</span><span class="p">[</span><span class="s1">'defaults'</span><span class="p">][</span><span class="s1">'driver'</span><span class="p">],</span>
        <span class="n">user</span><span class="o">=</span><span class="n">DEFAULT_DOTENV_KWARGS</span><span class="p">[</span><span class="s1">'defaults'</span><span class="p">][</span><span class="s1">'user'</span><span class="p">],</span>
        <span class="n">password</span><span class="o">=</span><span class="n">DEFAULT_DOTENV_KWARGS</span><span class="p">[</span><span class="s1">'defaults'</span><span class="p">][</span><span class="s1">'password'</span><span class="p">],</span>
        <span class="n">host</span><span class="o">=</span><span class="n">DEFAULT_DOTENV_KWARGS</span><span class="p">[</span><span class="s1">'defaults'</span><span class="p">][</span><span class="s1">'host'</span><span class="p">],</span>
        <span class="n">port</span><span class="o">=</span><span class="n">DEFAULT_DOTENV_KWARGS</span><span class="p">[</span><span class="s1">'defaults'</span><span class="p">][</span><span class="s1">'port'</span><span class="p">],</span>
        <span class="n">database</span><span class="o">=</span><span class="n">DEFAULT_DOTENV_KWARGS</span><span class="p">[</span><span class="s1">'defaults'</span><span class="p">][</span><span class="s1">'database'</span><span class="p">],</span>
        <span class="n">load_env</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="n">DatabaseDotEnv</span><span class="p">(),</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="c1"># (Database_connect_str) Build connection str from parameters</span>
        <span class="n">connection_str</span> <span class="o">=</span> <span class="n">get_database_url</span><span class="p">(</span>
            <span class="n">driver</span><span class="o">=</span><span class="n">driver</span><span class="p">,</span>
            <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>
            <span class="n">load_env</span><span class="o">=</span><span class="n">load_env</span><span class="p">,</span>
            <span class="n">env</span><span class="o">=</span><span class="n">env</span>
        <span class="p">)</span>

        <span class="c1"># (Database_attr) Create attributes for database obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connection</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">connection_str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inspector</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">MetaData</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="p">)</span>
    
<div class="viewcode-block" id="Database._build_query"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database._build_query">[docs]</a>    <span class="k">def</span> <span class="nf">_build_query</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">where</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">aggregate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">aggregate_func</span><span class="o">=</span><span class="s1">'count'</span><span class="p">,</span>
        <span class="n">order_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">order_by_sort</span><span class="o">=</span><span class="s1">'asc'</span><span class="p">,</span>
        <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">where_boolean</span><span class="o">=</span><span class="s1">'AND'</span><span class="p">,</span>
        <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Get a SQL select statement using sqlalchemy functions.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the database table.</span>
<span class="sd">        select : str or list(str) or list(:class:`sqlalchemy:sqlalchemy.schema.Column`) or None</span>
<span class="sd">            List of column names or a single column name to filter or select from the table. If ``None`` then all columns will be selected.</span>
<span class="sd">        where : list of list or list of tuple or None</span>
<span class="sd">            list of where statements the form of ``['column_name', 'operator', value]`` to further filter individual values or rows.</span>

<span class="sd">            * Operators are one of:</span>

<span class="sd">                .. jupyter-execute::</span>
<span class="sd">                    :hide-code:</span>

<span class="sd">                    from msdss_base_database.defaults import DEFAULT_SUPPORTED_OPERATORS</span>
<span class="sd">                    for operator in DEFAULT_SUPPORTED_OPERATORS:</span>
<span class="sd">                        print(operator)</span>
<span class="sd">                        </span>
<span class="sd">            * Values can be any single value such as ``int`` or ``str``</span>
<span class="sd">            * Examples: ``['column_two', '&gt;', 2]``, ``['column_one', 'LIKE', 'a']``, ``[['column_two', '&gt;', 2], ['column_one', 'LIKE', 'a']]``</span>
<span class="sd">        </span>
<span class="sd">        group_by : str or list(str) or None</span>
<span class="sd">            Single or list of column names to group by. This should be used with ``aggregate`` and ``aggregate_func``.</span>
<span class="sd">        aggregate : str or list(str) or None</span>
<span class="sd">            Single or list of column names to aggregate using the ``aggregate_func``. This should be used with ``group_by`` and ``aggregate_func``.</span>
<span class="sd">        aggregate_func : str or list(str)</span>
<span class="sd">            Function name (such as 'count' or 'sum') from :class:`sqlalchemy:sqlalchemy.sql.functions.Function` for aggregating records from each ``aggregate`` column.</span>
<span class="sd">            If a list of str, then it must have the same number of elements as ``aggregate`` or else only the shortest length list will be used.</span>
<span class="sd">        order_by : str or list(str) or None</span>
<span class="sd">            Single or list of column names to order or sort by.</span>
<span class="sd">        order_by_sort : str or list(str)</span>
<span class="sd">            Sort the records in increasing or decreasing order by each column in ``order_by``, where the value can be one of 'asc' for ascending or 'desc' for descending'.</span>
<span class="sd">            If a list of str, then it must have the same number of elements as ``order_by`` or else only the shortest length list will be used.</span>
<span class="sd">        limit : int or None</span>
<span class="sd">            Integer number to limit the number of rows returned.</span>
<span class="sd">        where_boolean : str</span>
<span class="sd">            One of ``AND`` or ``OR`` to combine ``where`` statements with. Defaults to ``AND`` if not one of ``AND`` or ``OR``.</span>
<span class="sd">        update : bool</span>
<span class="sd">            Whether to update rows from the table matching the query or not. Overrides the ``select`` parameter.</span>
<span class="sd">        delete : bool</span>
<span class="sd">            Whether to delete rows from the table matching the query or not. Overrides the ``select`` and ``update`` parameters.</span>
<span class="sd">        values : dict</span>
<span class="sd">            A dictionary of values to use for update if the ``update`` parameter is ``True`` and not overridden.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments to accept any extra parameters passed through.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`sqlalchemy:sqlalchemy.sql.expression.Select`</span>
<span class="sd">            sqlalchemy object that represents a table in the database.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            </span>
<span class="sd">            # Setup database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>
<span class="sd">            </span>
<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>
<span class="sd">            </span>
<span class="sd">            # Select columns and limit to 6 rows</span>
<span class="sd">            sql_limit = db._build_query(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select = ['column_one', 'column_two'],</span>
<span class="sd">                limit=6</span>
<span class="sd">            )</span>

<span class="sd">            # Select columns with where statement</span>
<span class="sd">            sql_where = db._build_query(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select='column_one',</span>
<span class="sd">                where=[('column_two', '&lt;', 3), ('column_one', '=', 'b')],</span>
<span class="sd">                where_boolean='AND'</span>
<span class="sd">            )</span>

<span class="sd">            # Select columns and order each column</span>
<span class="sd">            sql_order = db._build_query(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select=['column_one', 'column_two'],</span>
<span class="sd">                order_by=['column_one', 'column_two'],</span>
<span class="sd">                order_by_sort=['asc', 'desc']</span>
<span class="sd">            )</span>
<span class="sd">            </span>
<span class="sd">            # Select columns, group, and aggregate data</span>
<span class="sd">            sql_agg = db._build_query(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select='column_one',</span>
<span class="sd">                group_by='column_one',</span>
<span class="sd">                aggregate=['column_two', 'column_one'],</span>
<span class="sd">                aggregate_func=['sum', 'count']</span>
<span class="sd">            )</span>

<span class="sd">            # Update rows</span>
<span class="sd">            sql_update = db._build_query(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                where=[('id', '=', 1)],</span>
<span class="sd">                values=dict(column_one='A'),</span>
<span class="sd">                update=True</span>
<span class="sd">            )</span>

<span class="sd">            # Delete rows</span>
<span class="sd">            sql_delete = db._build_query(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                where=[('column_two', '&lt;', 2), ('column_one', '=', 'a')],</span>
<span class="sd">                where_boolean='OR',</span>
<span class="sd">                delete=True</span>
<span class="sd">            )</span>

<span class="sd">            # Display gen statements</span>
<span class="sd">            print('sql_limit:\\n\\n' + str(sql_limit))</span>
<span class="sd">            print('\\nsql_where:\\n\\n' + str(sql_where))</span>
<span class="sd">            print('\\nsql_order:\\n\\n' + str(sql_order))</span>
<span class="sd">            print('\\nsql_agg:\\n\\n' + str(sql_agg))</span>
<span class="sd">            print('\\nsql_update:\\n\\n' + str(sql_update))</span>
<span class="sd">            print('\\nsql_delete:\\n\\n' + str(sql_delete))</span>
<span class="sd">        """</span>
        
        <span class="c1"># (Database_build_query_var_list) Format single variables into lists</span>
        <span class="n">select</span> <span class="o">=</span> <span class="p">[</span><span class="n">select</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">select</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">select</span>
        <span class="n">group_by</span> <span class="o">=</span> <span class="p">[</span><span class="n">group_by</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_by</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">group_by</span>
        <span class="n">aggregate</span> <span class="o">=</span> <span class="p">[</span><span class="n">aggregate</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aggregate</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">aggregate</span>
        <span class="n">order_by</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_by</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_by</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">order_by</span>
                
        <span class="c1"># (Database_build_query_table) Get the table object</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        
        <span class="c1"># (Database_build_query_select) Gather columns to select</span>
        <span class="n">select_columns</span> <span class="o">=</span>  <span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">select</span><span class="p">]</span>
        
        <span class="c1"># (Database_build_query_aggregate) Gather aggregation columns to select</span>
        <span class="k">if</span> <span class="n">aggregate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">aggregate_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">aggregate</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aggregate_func</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">aggregate_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="n">f</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aggregate</span><span class="p">,</span> <span class="n">aggregate_func</span><span class="p">)]</span>
                <span class="n">aggregate_columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">sqlalchemy</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">())(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aggregate_columns</span><span class="p">,</span> <span class="n">aggregate_func</span><span class="p">,</span> <span class="n">aggregate_labels</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">aggregate_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="n">aggregate_func</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">aggregate</span><span class="p">]</span>
                <span class="n">aggregate_columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">sqlalchemy</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">aggregate_func</span><span class="p">)(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aggregate_columns</span><span class="p">,</span> <span class="n">aggregate_labels</span><span class="p">)]</span>
            <span class="n">select_columns</span> <span class="o">=</span> <span class="n">select_columns</span> <span class="o">+</span> <span class="n">aggregate_columns</span>
            
        <span class="c1"># (Database_build_query_operation) Add select, update, or delete statement</span>
        <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">select_columns</span><span class="p">)</span>
        
        <span class="c1"># (Database_build_query_where) Add where statement</span>
        <span class="k">if</span> <span class="n">where</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># (Database_build_query_where_format) Get where boolean operator and ensure two-dimensional list</span>
            <span class="n">where</span> <span class="o">=</span> <span class="p">[</span><span class="n">where</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">where</span><span class="p">)</span> <span class="k">else</span> <span class="n">where</span>
            <span class="n">where_boolean</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">or_</span> <span class="k">if</span> <span class="n">where_boolean</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'or'</span> <span class="k">else</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">and_</span>
            
            <span class="c1"># (Database_build_query_where_convert) Convert list to where clauses</span>
            <span class="n">where_clauses</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">clause_list</span> <span class="ow">in</span> <span class="n">where</span><span class="p">:</span>

                <span class="c1"># (Database_build_query_where_convert_vars) Get clause parts from list</span>
                <span class="n">clause_col</span> <span class="o">=</span> <span class="n">clause_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">clause_op</span> <span class="o">=</span> <span class="n">clause_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">clause_val</span> <span class="o">=</span> <span class="n">clause_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

                <span class="c1"># (Database_build_query_where_convert_op) Convert to clause based on operator</span>
                <span class="k">if</span> <span class="n">clause_op</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'='</span><span class="p">,</span> <span class="s1">'=='</span><span class="p">):</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">clause_val</span>
                <span class="k">elif</span> <span class="n">clause_op</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'!='</span><span class="p">,</span> <span class="s1">'!=='</span><span class="p">):</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span> <span class="o">!=</span> <span class="n">clause_val</span>
                <span class="k">elif</span> <span class="n">clause_op</span> <span class="o">==</span> <span class="s1">'&gt;'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">clause_val</span>
                <span class="k">elif</span> <span class="n">clause_op</span> <span class="o">==</span> <span class="s1">'&gt;='</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">clause_val</span>
                <span class="k">elif</span> <span class="n">clause_op</span> <span class="o">==</span> <span class="s1">'&lt;'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">clause_val</span>
                <span class="k">elif</span> <span class="n">clause_op</span> <span class="o">==</span> <span class="s1">'&lt;='</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">clause_val</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'like'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'notlike'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">notlike</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'ilike'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">ilike</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'notilike'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">notilike</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'contains'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'startswith'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">clause_op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'endswith'</span><span class="p">:</span>
                    <span class="n">clause</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">clause_col</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">clause_val</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">clause_op</span> <span class="o">+</span> <span class="s1">' is not supported'</span><span class="p">)</span>
                <span class="n">where_clauses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clause</span><span class="p">)</span>

            <span class="c1"># (Database_build_query_where_add) Add where clauses to select query</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">where_boolean</span><span class="p">(</span><span class="o">*</span><span class="n">where_clauses</span><span class="p">))</span>
            
        <span class="c1"># (Database_build_query_group) Add group by statement</span>
        <span class="k">if</span> <span class="n">group_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">group_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">group_by</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="o">*</span><span class="n">group_by_columns</span><span class="p">)</span>
            
        <span class="c1"># (Database_build_query_order) Add order by statement</span>
        <span class="k">if</span> <span class="n">order_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">order_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">order_by</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_by_sort</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">order_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">())()</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">order_by_columns</span><span class="p">,</span> <span class="n">order_by_sort</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">order_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">order_by_sort</span><span class="p">)()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">order_by_columns</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_columns</span><span class="p">)</span>
            
        <span class="c1"># (Database_build_query_limit) Add limit statement</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>

        <span class="c1"># (Database_build_query_values) Add values statement</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="o">**</span><span class="n">values</span><span class="p">)</span>
            
        <span class="c1"># (Database_build_query_return) Return the sqlachemy query</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Database._execute_query"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database._execute_query">[docs]</a>    <span class="k">def</span> <span class="nf">_execute_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Executes a query statement.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sql : str</span>
<span class="sd">            SQL str representing the query statement to execute.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional parameters passed to :func:`sqlalchemy:sqlalchemy.engine.Connection.execute`.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`sqlalchemy:sqlalchemy.engine.CursorResult`</span>
<span class="sd">            Cursor result from query.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>
<span class="sd">            </span>
<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # Write sample data</span>
<span class="sd">            data = {</span>
<span class="sd">                'id': [1, 2, 3],</span>
<span class="sd">                'column_one': ['a', 'b', 'c'],</span>
<span class="sd">                'column_two': [2, 4, 6]</span>
<span class="sd">            }</span>
<span class="sd">            db.insert('test_table', data)</span>
<span class="sd">            </span>
<span class="sd">            # Get data from query</span>
<span class="sd">            cursor = db._execute_query('SELECT * FROM test_table LIMIT 5;')</span>
<span class="sd">            cursor = db._execute_query('SELECT column_one, column_two FROM test_table WHERE column_two &gt; 3;')</span>
<span class="sd">        """</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Database._get_table"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database._get_table">[docs]</a>    <span class="k">def</span> <span class="nf">_get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Get a table object from the database.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to remove.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :class:`sqlalchemy.schema.Table`.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        :class:`sqlalchemy.schema.Table`</span>
<span class="sd">            A ``Table`` object from ``sqlalchemy``.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>

<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # Get the table object</span>
<span class="sd">            tb = db._get_table('test_table')</span>
<span class="sd">            print(str(tb))</span>
<span class="sd">        """</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span> <span class="n">autoload_with</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Database._list_to_columns"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database._list_to_columns">[docs]</a>    <span class="k">def</span> <span class="nf">_list_to_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clist</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Converts a list of dict or list to ``sqlalchemy`` columns.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        clist : list(dict) or list(list)</span>
<span class="sd">            List of dict (kwargs) or lists (positional args) that are passed to :class:`sqlalchemy.schema.Column`. Data types can also be specified as str.</span>
<span class="sd">            </span>
<span class="sd">            * Example list(dict): ``[dict(name='id', type_='Integer', autoincrement=True, primary_key=True), dict(name='col', type='String')]``</span>
<span class="sd">            * Example list(list): ``[('id', 'Integer'), ('col', 'String')]``</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :class:`sqlalchemy.schema.Table`.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        list(:class:`sqlalchemy.schema.Column`)</span>
<span class="sd">            A list of ``Column`` objects from ``sqlalchemy``.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Create column definitions</span>
<span class="sd">            clist = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                dict(name='column_one', type_='String'),</span>
<span class="sd">                dict(name='column_two', type_='Integer')</span>
<span class="sd">            ]</span>

<span class="sd">            # Convert to sqlalchemy column objects</span>
<span class="sd">            columns = db._list_to_columns(clist)</span>
<span class="sd">            print(str(columns))</span>
<span class="sd">        """</span>

        <span class="c1"># (Database_list_to_columns_convert) Convert data types from str</span>
        <span class="n">clist</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clist</span><span class="p">]</span> <span class="c1"># conv tuples to list</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clist</span><span class="p">):</span>

            <span class="c1"># (Database_list_to_columns_convert_type) Get data type depending on list or dict</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">cidx</span> <span class="o">=</span> <span class="s1">'type_'</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">cidx</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">ctype</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">cidx</span><span class="p">]</span>
            
            <span class="c1"># (Databse_list_columns_convert_str) Convert to column if str</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctype</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">clist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">cidx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sqlalchemy</span><span class="p">,</span> <span class="n">ctype</span><span class="p">)</span>

        <span class="c1"># (Database_list_to_columns_return) Return the list of sqlalchemy columns</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="o">**</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clist</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Database._write_data"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database._write_data">[docs]</a>    <span class="k">def</span> <span class="nf">_write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'append'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Write data to the database.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to write to.</span>
<span class="sd">        data : dict or list or :class:`pandas:pandas.DataFrame`</span>
<span class="sd">            Dataframe with the data to write to the database. If ``dict`` or ``list`` see :class:`pandas:pandas.DataFrame`.</span>
<span class="sd">        schema : str</span>
<span class="sd">            Name of the schema to for the table.</span>
<span class="sd">        if_exists : 'fail' or 'replace' or 'append'</span>
<span class="sd">            String indicating whether to throw an error (fail), replace the data, or append the data to the table if it already exists.</span>
<span class="sd">        index : bool</span>
<span class="sd">            Set to True to include the row indices as a column and False to omit them.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :class:`pandas:pandas.DataFrame` if parameter ``data`` is ``dict`` or ``list``.</span>
<span class="sd">        </span>
<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database import Database</span>
<span class="sd">            </span>
<span class="sd">            # Setup database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>
<span class="sd">            </span>
<span class="sd">            # Write data to table</span>
<span class="sd">            data = {</span>
<span class="sd">                'id': [1, 2, 3],</span>
<span class="sd">                'column_one': ['a', 'b', 'c'],</span>
<span class="sd">                'column_two': [2, 4, 6]</span>
<span class="sd">            }</span>
<span class="sd">            db._write_data('test_table', data, if_exists = 'replace')</span>
<span class="sd">        """</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
        <span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="n">if_exists</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">index</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Database.create_table"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.create_table">[docs]</a>    <span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Create a table in the database.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to create.</span>
<span class="sd">        columns : list(dict) or list(list)</span>
<span class="sd">            List of dict (kwargs) or lists (positional args) that are passed to :class:`sqlalchemy.schema.Column`. Data types can also be specified as str.</span>
<span class="sd">            </span>
<span class="sd">            * Example list(dict): ``[dict(name='id', type_='Integer', autoincrement=True, primary_key=True), dict(name='col', type='String')]``</span>
<span class="sd">            * Example list(list): ``[('id', 'Integer'), ('col', 'String')]``</span>

<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :class:`msdss_base_database.core.Database._write` except that parameter ``if_exists`` is set to ``fail`` or ``replace`` only.</span>
<span class="sd">        </span>
<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database import Database</span>
<span class="sd">            </span>
<span class="sd">            # Setup database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Drop table if exists</span>
<span class="sd">            if db.has_table('test_table'):</span>
<span class="sd">                db.drop_table('test_table')</span>

<span class="sd">            # Create column definitions</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                dict(name='column_one', type_='String'),</span>
<span class="sd">                dict(name='column_two', type_='Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            </span>
<span class="sd">            # Create the table</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # View the table</span>
<span class="sd">            df = db.select('test_table')</span>
<span class="sd">            print(df)</span>
<span class="sd">        """</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_columns</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span> <span class="o">*</span><span class="n">columns</span><span class="p">,</span> <span class="n">extend_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tb</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="p">)</span></div>

<div class="viewcode-block" id="Database.delete"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">where_boolean</span><span class="o">=</span><span class="s1">'AND'</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Remove rows from a table in the database.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to remove rows from.</span>
<span class="sd">        where : list of list or list of tuple or None</span>
<span class="sd">            list of where statements the form of ``['column_name', 'operator', value]`` to further filter individual values or rows. </span>
<span class="sd">            See parameter ``where`` in :meth:`msdss_base_database.core.Database._build_query`.</span>
<span class="sd">        where_boolean : str</span>
<span class="sd">            One of ``AND`` or ``OR`` to combine ``where`` statements with. Defaults to ``AND`` if not one of ``AND`` or ``OR``.</span>
<span class="sd">            </span>
<span class="sd">            * Operators are one of:</span>

<span class="sd">                .. jupyter-execute::</span>
<span class="sd">                    :hide-code:</span>

<span class="sd">                    from msdss_base_database.defaults import DEFAULT_SUPPORTED_OPERATORS</span>
<span class="sd">                    for operator in DEFAULT_SUPPORTED_OPERATORS:</span>
<span class="sd">                        print(operator)</span>
<span class="sd">                        </span>
<span class="sd">            * Values can be any single value such as ``int`` or ``str``</span>
<span class="sd">            * Examples: ``['column_two', '&gt;', 2]``, ``['column_one', 'LIKE', 'a']``, ``[['column_two', '&gt;', 2], ['column_one', 'LIKE', 'a']]``</span>

<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :meth:`msdss_base_database.core.Database._execute_query`.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>

<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # Write sample data</span>
<span class="sd">            data = {</span>
<span class="sd">                'id': [1, 2, 3],</span>
<span class="sd">                'column_one': ['a', 'b', 'c'],</span>
<span class="sd">                'column_two': [2, 4, 6]</span>
<span class="sd">            }</span>
<span class="sd">            db.insert('test_table', data)</span>
<span class="sd">            df = db.select('test_table')</span>

<span class="sd">            # Delete a row with matching id</span>
<span class="sd">            db.delete(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                where=('id', '=', 1)</span>
<span class="sd">            )</span>
<span class="sd">            df_delete_id = db.select('test_table')</span>

<span class="sd">            # Delete a row with matching query</span>
<span class="sd">            db.delete(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                where=[('id', '&lt;', 3), ('column_one', '=', 'c')],</span>
<span class="sd">                where_boolean='OR'</span>
<span class="sd">            )</span>
<span class="sd">            df_delete_where = db.select('test_table')</span>

<span class="sd">            # Print results</span>
<span class="sd">            print('df:\\n')</span>
<span class="sd">            print(df)</span>
<span class="sd">            print('\\ndf_delete_id:\\n')</span>
<span class="sd">            print(df_delete_id)</span>
<span class="sd">            print('\\ndf_delete_where:\\n')</span>
<span class="sd">            print(df_delete_where)</span>
<span class="sd">        """</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">where_boolean</span><span class="o">=</span><span class="n">where_boolean</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Database.drop_table"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.drop_table">[docs]</a>    <span class="k">def</span> <span class="nf">drop_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Remove a table from the database.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to remove.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :meth:`sqlalchemy.schema.Table.drop`.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>

<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>
<span class="sd">            before_drop = db.has_table('test_table')</span>

<span class="sd">            # Drop the table</span>
<span class="sd">            db.drop_table('test_table')</span>
<span class="sd">            after_drop = db.has_table('test_table')</span>

<span class="sd">            # Print results</span>
<span class="sd">            print('before_drop: ' + str(before_drop))</span>
<span class="sd">            print('after_drop: ' + str(after_drop))</span>
<span class="sd">        """</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="n">tb</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Database.has_table"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.has_table">[docs]</a>    <span class="k">def</span> <span class="nf">has_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Check if a table exists.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to check.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :meth:`sqlalchemy.engine.reflection.Inspector.has_table`.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        bool</span>
<span class="sd">            Returns ``True`` if the table exists and ``False`` otherwise.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Drop the table if it exists</span>
<span class="sd">            if db.has_table('test_table'):</span>
<span class="sd">                db.drop_table('test_table')</span>
<span class="sd">            before_create = db.has_table('test_table') # False</span>
<span class="sd">            </span>
<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # Check if table exists again</span>
<span class="sd">            after_create = db.has_table('test_table') # True</span>

<span class="sd">            # Print results</span>
<span class="sd">            print('before_create: ' + str(before_create))</span>
<span class="sd">            print('after_create: ' + str(after_create))</span>
<span class="sd">        """</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspector</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Database.insert"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Insert additional data to the database.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to insert additional data to.</span>
<span class="sd">        data : dict or list or :class:`pandas:pandas.DataFrame`</span>
<span class="sd">            Dataframe with the data to write to the database. If ``dict`` or ``list`` see :class:`pandas:pandas.DataFrame`.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :meth:`msdss_base_database.core.Database._write`. Except that ``if_exists`` is always set to ``append``.</span>
<span class="sd">        </span>
<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database import Database</span>
<span class="sd">            </span>
<span class="sd">            # Setup database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>

<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>
<span class="sd">            df = db.select('test_table')</span>
<span class="sd">            </span>
<span class="sd">            # Write data to table</span>
<span class="sd">            data = {</span>
<span class="sd">                'id': [1, 2, 3],</span>
<span class="sd">                'column_one': ['a', 'b', 'c'],</span>
<span class="sd">                'column_two': [2, 4, 6]</span>
<span class="sd">            }</span>
<span class="sd">            db.insert('test_table', data)</span>
<span class="sd">            df_insert = db.select('test_table')</span>

<span class="sd">            # Insert more new values to table</span>
<span class="sd">            more_new = {</span>
<span class="sd">                'id': [5, 6, 7],</span>
<span class="sd">                'column_one': ['e', 'f', 'g'],</span>
<span class="sd">                'column_two': [10, 12, 14]</span>
<span class="sd">            }</span>
<span class="sd">            db.insert('test_table', more_new)</span>
<span class="sd">            df_insert_more = db.select('test_table')</span>

<span class="sd">            # Display results</span>
<span class="sd">            print('df:\\n')</span>
<span class="sd">            print(df)</span>
<span class="sd">            print('\\ndf_insert:\\n')</span>
<span class="sd">            print(df_insert)</span>
<span class="sd">            print('\\ndf_insert_more:\\n')</span>
<span class="sd">            print(df_insert_more)</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_data</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">'append'</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Database.select"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.select">[docs]</a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">select</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">where</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">group_by</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">aggregate</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">aggregate_func</span> <span class="o">=</span> <span class="s1">'count'</span><span class="p">,</span>
        <span class="n">order_by</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">order_by_sort</span> <span class="o">=</span> <span class="s1">'asc'</span><span class="p">,</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">where_boolean</span> <span class="o">=</span> <span class="s1">'AND'</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Query data from a table in the database.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the database table to query from.</span>
<span class="sd">        select : str or list(str or list:class:`sqlalchemy:sqlalchemy.schema.Column`) or None</span>
<span class="sd">            List of column names or a single column name to filter or select from the table. If ``None`` then all columns will be selected.</span>
<span class="sd">        where : list of list or list of tuple or None</span>
<span class="sd">            list of where statements the form of ``['column_name', 'operator', value]`` to further filter individual values or rows.</span>
<span class="sd">            </span>
<span class="sd">            * Operators are one of:</span>

<span class="sd">                .. jupyter-execute::</span>
<span class="sd">                    :hide-code:</span>

<span class="sd">                    from msdss_base_database.defaults import DEFAULT_SUPPORTED_OPERATORS</span>
<span class="sd">                    for operator in DEFAULT_SUPPORTED_OPERATORS:</span>
<span class="sd">                        print(operator)</span>
<span class="sd">                        </span>
<span class="sd">            * Values can be any single value such as ``int`` or ``str``</span>
<span class="sd">            * Examples: ``['column_two', '&gt;', 2]``, ``['column_one', 'LIKE', 'a']``, ``[['column_two', '&gt;', 2], ['column_one', 'LIKE', 'a']]``            </span>

<span class="sd">        group_by : str or list(str) or None</span>
<span class="sd">            Single or list of column names to group by. This should be used with ``aggregate`` and ``aggregate_func``.</span>
<span class="sd">        aggregate : str or list(str) or None</span>
<span class="sd">            Single or list of column names to aggregate using the ``aggregate_func``. This should be used with ``group_by`` and ``aggregate_func``.</span>
<span class="sd">        aggregate_func : str or list(str)</span>
<span class="sd">            Function name (such as 'count' or 'sum') from :class:`sqlalchemy:sqlalchemy.sql.functions.Function` for aggregating records from each ``aggregate`` column.</span>
<span class="sd">            If a list of str, then it must have the same number of elements as ``aggregate`` or else only the shortest length list will be used.</span>
<span class="sd">        order_by : str or list(str) or None</span>
<span class="sd">            Single or list of column names to order or sort by.</span>
<span class="sd">        order_by_sort : str or list(str)</span>
<span class="sd">            Sort the records in increasing or decreasing order by each column in ``order_by``, where the value can be one of 'asc' for ascending or 'desc' for descending'.</span>
<span class="sd">            If a list of str, then it must have the same number of elements as ``order_by`` or else only the shortest length list will be used.</span>
<span class="sd">        limit : int or None</span>
<span class="sd">            Integer number to limit the number of rows returned.</span>
<span class="sd">        where_boolean : str</span>
<span class="sd">            One of ``AND`` or ``OR`` to combine ``where`` statements with. Defaults to ``AND`` if not one of ``AND`` or ``OR``.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional parameters passed to :meth:`pandas:pandas.read_sql`.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pandas:pandas.DataFrame`</span>
<span class="sd">            pandas dataframe containing the queried data.</span>

<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database.core import Database</span>
<span class="sd">            </span>
<span class="sd">            # Setup database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>
<span class="sd">            </span>
<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # Write sample data</span>
<span class="sd">            data = {</span>
<span class="sd">                'id': [1, 2, 3],</span>
<span class="sd">                'column_one': ['a', 'b', 'c'],</span>
<span class="sd">                'column_two': [2, 4, 6]</span>
<span class="sd">            }</span>
<span class="sd">            db.insert('test_table', data)</span>
<span class="sd">            df = db.select('test_table')</span>
<span class="sd">            </span>
<span class="sd">            # Read data from table using select and limit</span>
<span class="sd">            data = db.select(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select = ['column_one', 'column_two'],</span>
<span class="sd">                limit = 5</span>
<span class="sd">            )</span>
<span class="sd">            df_select = db.select('test_table')</span>

<span class="sd">            # Use where statements</span>
<span class="sd">            data = db.select(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select = 'column_one',</span>
<span class="sd">                where = [('column_two', '&lt;', '15'), ('column_one', '=', 'b')],</span>
<span class="sd">                where_boolean = 'AND'</span>
<span class="sd">            )</span>
<span class="sd">            df_where = db.select('test_table')</span>

<span class="sd">            # Order results</span>
<span class="sd">            data = db.select(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select = ['column_one', 'column_two'],</span>
<span class="sd">                order_by = ['column_one', 'column_two'],</span>
<span class="sd">                order_by_sort = ['asc', 'desc']</span>
<span class="sd">            )</span>
<span class="sd">            df_order = db.select('test_table')</span>

<span class="sd">            # Aggregate read</span>
<span class="sd">            data = db.select(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                select = 'column_one',</span>
<span class="sd">                group_by = 'column_one',</span>
<span class="sd">                aggregate = 'column_two',</span>
<span class="sd">                aggregate_func = ['count', 'sum']</span>
<span class="sd">            )</span>
<span class="sd">            df_agg = db.select('test_table')</span>

<span class="sd">            # Display results</span>
<span class="sd">            print('df:\\n')</span>
<span class="sd">            print(df)</span>
<span class="sd">            print('\\ndf_select:\\n')</span>
<span class="sd">            print(df_select)</span>
<span class="sd">            print('\\ndf_where:\\n')</span>
<span class="sd">            print(df_where)</span>
<span class="sd">            print('\\ndf_order:\\n')</span>
<span class="sd">            print(df_order)</span>
<span class="sd">            print('\\ndf_agg:\\n')</span>
<span class="sd">            print(df_agg)</span>
<span class="sd">        """</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span>
            <span class="n">table</span><span class="p">,</span>
            <span class="n">select</span><span class="o">=</span><span class="n">select</span><span class="p">,</span>
            <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
            <span class="n">group_by</span><span class="o">=</span><span class="n">group_by</span><span class="p">,</span>
            <span class="n">aggregate</span><span class="o">=</span><span class="n">aggregate</span><span class="p">,</span>
            <span class="n">aggregate_func</span><span class="o">=</span><span class="n">aggregate_func</span><span class="p">,</span>
            <span class="n">order_by</span><span class="o">=</span><span class="n">order_by</span><span class="p">,</span>
            <span class="n">order_by_sort</span><span class="o">=</span><span class="n">order_by_sort</span><span class="p">,</span>
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
            <span class="n">where_boolean</span><span class="o">=</span><span class="n">where_boolean</span>
        <span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span> <span class="o">=</span> <span class="n">sql</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connection</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="Database.update"><a class="viewcode-back" href="../../reference/core.html#msdss_base_database.core.Database.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Update a table from the database.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            Name of the table to update.</span>
<span class="sd">        where : list of list or list of tuple or None</span>
<span class="sd">            list of where statements the form of ``['column_name', 'operator', value]`` to update individual values or rows.</span>
<span class="sd">            </span>
<span class="sd">            * Operators are one of:</span>

<span class="sd">                .. jupyter-execute::</span>
<span class="sd">                    :hide-code:</span>

<span class="sd">                    from msdss_base_database.defaults import DEFAULT_SUPPORTED_OPERATORS</span>
<span class="sd">                    for operator in DEFAULT_SUPPORTED_OPERATORS:</span>
<span class="sd">                        print(operator)</span>
<span class="sd">                        </span>
<span class="sd">            * Values can be any single value such as ``int`` or ``str``</span>
<span class="sd">            * Examples: ``['column_two', '&gt;', 2]``, ``['column_one', 'LIKE', 'a']``, ``[['column_two', '&gt;', 2], ['column_one', 'LIKE', 'a']]``</span>

<span class="sd">        values : dict</span>
<span class="sd">            Dictionary representing values to update if they match the ``where`` parameter requirements.</span>
<span class="sd">        *args, **kwargs</span>
<span class="sd">            Additional arguments passed to :meth:`msdss_base_database.core.Database._execute_query`.</span>
<span class="sd">        </span>
<span class="sd">        Author</span>
<span class="sd">        ------</span>
<span class="sd">        Richard Wen &lt;rrwen.dev@gmail.com&gt;</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        .. jupyter-execute::</span>

<span class="sd">            from msdss_base_database import Database</span>
<span class="sd">            </span>
<span class="sd">            # Setup database</span>
<span class="sd">            db = Database()</span>

<span class="sd">            # Check if the table exists and drop if it does</span>
<span class="sd">            if db.has_table("test_table"):</span>
<span class="sd">                db.drop_table("test_table")</span>
<span class="sd">            </span>
<span class="sd">            # Create sample table</span>
<span class="sd">            columns = [</span>
<span class="sd">                dict(name='id', type_='Integer', primary_key=True),</span>
<span class="sd">                ('column_one', 'String'),</span>
<span class="sd">                ('column_two', 'Integer')</span>
<span class="sd">            ]</span>
<span class="sd">            db.create_table('test_table', columns)</span>

<span class="sd">            # Write sample data</span>
<span class="sd">            data = {</span>
<span class="sd">                'id': [1, 2, 3],</span>
<span class="sd">                'column_one': ['a', 'b', 'c'],</span>
<span class="sd">                'column_two': [2, 4, 6]</span>
<span class="sd">            }</span>
<span class="sd">            db.insert('test_table', data)</span>
<span class="sd">            df = db.select('test_table')</span>

<span class="sd">            # Update values in table</span>
<span class="sd">            db.update(</span>
<span class="sd">                'test_table',</span>
<span class="sd">                where=('id', '&gt;', 1),</span>
<span class="sd">                values={'column_one': 'AA'})</span>
<span class="sd">            df_update = db.select('test_table')</span>
<span class="sd">            </span>
<span class="sd">            # Print results</span>
<span class="sd">            print('df:\\n')</span>
<span class="sd">            print(df)</span>
<span class="sd">            print('\\ndf_update:\\n')</span>
<span class="sd">            print(df_update)</span>
<span class="sd">        """</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_query</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
</pre></div>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2021, Richard Wen.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>